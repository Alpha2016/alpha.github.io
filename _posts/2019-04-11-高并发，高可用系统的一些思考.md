---
layout:     post
title:      高并发，高可用系统的一些思考
subtitle:   高并发，高可用系统的一些思考
date:       2019-04-11
author:     he xiaodong
header-img: img/default-post-bg.jpg
catalog: true
tags:
    - 高并发
    - 高可用
    - 负载均衡
---

> 个人理解高并发系统主要在于：机器资源的合理分配和性能的压榨，代码质量，及维护高并发系统在请求峰值的时候，系统中有机器宕机时整个系统的可用性。**核心是提高吞吐，降低响应时间。**

##### 随意想
还有几个观点是：高并发技术可以有，但是很多公司没有高并发场景。越是没有高并发场景的公司越愿意问高并发的问题，是为了考察面试者对于行业尖端技能的学习还是为了压价？而有高并发场景的公司一般很在乎基础，基础好的人写出来的代码比烂代码性能强一点的话，并发时会严重放大提升的这一点性能。

至于在有并发场景之前的优化网站性能，多数情况会依赖：1. 前端资源 CDN 化，公用的资源编译压缩，同时使用浏览器自身缓存，提升资源加载速度，也减少访问一个页面给此域名带来很多的请求。 2. 优化 SQL 操作，95%+ 的问题是 sql 优化可以提升的，对应也有代码中的魔性操作，带来的执行效率的问题。

todo 完善更多

##### 突如其来的高并发
基本是被人刷了，或者比预估的情况要多了几倍，才有这种情况，前者可能性很大，最近这两年的金融网站，区块链，xx币网站，基本会被羊毛党盯上，没做好访问防作弊，或者被对手 ddos 攻击，都会造成高并发中网站瘫痪，清洗流量一般就可以的，不要让辣鸡流量贯穿整个业务。**高并发会带来网站请求慢，但网站请求慢不一定是高并发了**，对症下药。

##### 并发中的整体项目稳定性
可以将高并发的业务部分分离到单独的服务器。这种情况下能够避免这部分业务带来机器性能的消耗，从而影响整个项目的稳定性，这样的结果不太好的。
todo 或许想到更多

##### 预先测试
简单可以是压测关键业务部分，简单的查询一般不会带来问题，这个页面的静态资源太多，同时都在统一个域名下的话，相当于在现有并发的数量上加了更多，这非常不利，对于浏览器的加载也是不利的，简单业务也会体验很差。**压力测试应当遵循慢慢提升流量的方式，并发量和响应时间并不是等比例上涨的，慢慢提升并发量的测试，会展示代码的瓶颈部分在哪**，然后在去解决和提升。<bt />
在基础的并发测试之外，还有在正是服务器上的全链路压力测试，为了防止和真实数据冲突，可以将请求中加上额外的标记，或者针对特定的用户帐号测试，在数据中体现这部分额外标记，测试完毕之后将数据删除。<br />
同时，不要高并发的主要业务一直占用机器的 100% 的运算能力，这样整体逻辑和请求支持已经到了极限，基本再高一点就会造成问题，应该尽量让业务只占用机器 60-70% 的运算能力，留出一部分的余地，防止意外。


参考链接：
1. [构建一个高性能、高可用的大型分布式网站](https://www.toutiao.com/a6573634116791566851/ "构建一个高性能、高可用的大型分布式网站")
2. [关于高并发 - 知乎专栏](https://zhuanlan.zhihu.com/p/38636111 "关于高并发")
3. [如何获得高并发经验 - 知乎问答](https://www.zhihu.com/question/40609661)
4. [sf 我们讨论高并发的时候在讨论什么](https://segmentfault.com/a/1190000019360335)
