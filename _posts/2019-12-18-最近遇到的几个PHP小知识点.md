---
layout:     post
title:      最近遇到的几个PHP小知识点
subtitle:   最近遇到的几个PHP小知识点
date:       2019-12-18
author:     he xiaodong
header-img: img/default-post-bg.jpg
catalog: true
tags:
    - PHP
    - str_replace
    - substr_replace
    - laravel
---

> 好的框架能提升语言生态，也有时候能把让PHP程序员成为框架程序员，而不是更好的后端程序员，例如我这样的。

**测试环境为 PHP7.4 Windows 10系统**

##### str_replace 函数
一个小需求是类似单词填空题，从单词中替换到几个字母，变成 _，然后给出一些选项，例如 ax n, au h, ab y这样的，将选项一一对应的替换 _，和原单词比较，如果一致就是正确选项，本以为事情很简单，`str_replace` 函数支持两个数组之间的替换，例如
```php
$str = 'ab';
str_replace(['a', 'b'], ['c', 'd'], $str);

# output: cd
```

等位置交换，所以我写了这个

```php
<?php
# 原单词是 laugh

$str = 'l__g_';
$replace = 'au h';
$needle = array_fill(0, substr_count($str, '_') - 1, '_');
$replaceArray = array_filter(str_split($replace));

echo str_replace($needle, $replaceArray, $str);

# output: laaga
```

本以为很简单就可以输出 laugh，没有多想，实际上会在第一次 _ 替换 a 的情况下，直接将所有的 _ 替换为了 a, 再一次扫描替换已经没有 _ 了，执行完毕，所以最终结果毫无问题，是我想的简单了，换个思路只能一个个替换。
```php
<?php
# 原单词是 laugh

$str = 'l__g_';
$replace = 'au h';

$replaceArray = array_filter(str_split($replace));
for ($i = 0; $i < count($replaceArray); $i++) {
    $position = strpos($str, '_');
    $str = substr_replace($str, $replaceArray[$i], $position, 1);
}

echo $str;
```

源码
##### 对象的拷贝


